# go-solidity-obfuscator

The go-solidity-obfuscator is a Go implementation of a source-code-level obfuscator for smart contracts written in Solidity. It provides the following obfuscation features
- inserting opaque predicates into function bodies,
- inlining calls to private functions (cannot be used together with opaque predicates currently),
- comment removal,
- replacing variable names with underscore sequences, and
- replacing integer literals with arithmetic expressions.

## Usage 

### Requirements

The obfuscator can currently only be built from source, which requires Go 1.19 or higher.

### Installation

From the root of the repository, run:

```bash
go build cmd/main.go
```

This will generate an executable called `main`.

## Usage

The obfuscator requires a .sol contract file and a .json formatted AST file as inputs. The AST file should be generated by the [solc compiler](https://docs.soliditylang.org/en/latest/installing-solidity.html) using the `--ast-compact-json` option.

The path to the .sol and the AST are passed to the `main` executable, in this order, as positional arguments. The executable accepts two optional flags, which should be passed before the positional arguments. The flags are:
- `-output`, specifying the path to save the resulting obfuscated file to. Defaults to `.obfuscated.sol`.
- `-fobf`, specifying whether to use function inlining, or opaque predicate insertion. Can be set to either `opaque` or `inline`, anything else will throw an error. If ommited, defaults to `opaque`.

An example of running a contract named `example.sol`, with AST file named `example.sol_json.ast`; function inlining is chosen over opaque predicate insertion; the output file is set to `example_output.sol`:

```bash
./main -fobf=inline -output=example_output.sol ./example.sol ./example.sol_json.ast
```